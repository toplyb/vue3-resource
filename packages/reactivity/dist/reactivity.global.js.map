{"version":3,"file":"reactivity.global.js","sources":["../src/effect.ts","../../shared/src/index.ts","../src/reactive.ts"],"sourcesContent":["export function effect() {\n\n}\n","export function isObject(value: unknown): value is Record<any, any> {\n  return typeof value === 'object' && value !== null\n}\n","import { isObject } from '@vue/shared'\n\nconst enum ReactiveFlags {\n  IS_REACTIVE = '__v_isReactive'\n}\n\nconst mutableHandlers = {\n  get(target: Record<any, any>, key: string | symbol, receiver: any): any {\n    // 如果对象被代理过，则在刚进来的时候，就会取 __v_isReactive 属性，此时就可以直接返回 true\n    if (key === ReactiveFlags.IS_REACTIVE) {\n      return true\n    }\n    // 相当于 target[key]\n    const res = Reflect.get(target, key, receiver)\n    return res\n  },\n  set(target: Record<any, any>, key: string | symbol, value: any, receiver: any): boolean {\n    // 相当于 target[key] = value，但是 Reflect 会自动返回一个布尔值，表示是否设置成功\n    return Reflect.set(target, key, value, receiver)\n  }\n}\n\n// weakMap 是弱引用，key 必须是对象，如果 key 没有被引用，则会自动销毁\nconst reactiveMap = new WeakMap()\n\nfunction createReactiveObject(target: object) {\n\n  // 默认认为 target 是被代理过的\n  if ((target as any)[ReactiveFlags.IS_REACTIVE]) {\n    return target\n  }\n\n  if (!isObject(target)) {\n    return target\n  }\n\n  // 判断当前对象是否被代理过，如果被代理过，就直接返回代理后的对象\n  const existingProxy = reactiveMap.get(target)\n  if (existingProxy) {\n    return existingProxy\n  }\n\n  const proxy = new Proxy(target, mutableHandlers)\n  reactiveMap.set(target, proxy)\n  return proxy\n}\n\nexport function reactive(target: object) {\n  return createReactiveObject(target)\n}\n"],"names":[],"mappings":";;;WAAgB,MAAM,GAAA;EAEtB;;ECFM,SAAU,QAAQ,CAAC,KAAc,EAAA;MACrC,OAAO,OAAO,KAAK,KAAK,QAAQ,IAAI,KAAK,KAAK,IAAI,CAAA;EACpD;;ECIA,MAAM,eAAe,GAAG;EACtB,IAAA,GAAG,CAAC,MAAwB,EAAE,GAAoB,EAAE,QAAa,EAAA;;UAE/D,IAAI,GAAG,uDAAgC;EACrC,YAAA,OAAO,IAAI,CAAA;EACZ,SAAA;;EAED,QAAA,MAAM,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,GAAG,EAAE,QAAQ,CAAC,CAAA;EAC9C,QAAA,OAAO,GAAG,CAAA;OACX;EACD,IAAA,GAAG,CAAC,MAAwB,EAAE,GAAoB,EAAE,KAAU,EAAE,QAAa,EAAA;;EAE3E,QAAA,OAAO,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE,QAAQ,CAAC,CAAA;OACjD;GACF,CAAA;EAED;EACA,MAAM,WAAW,GAAG,IAAI,OAAO,EAAE,CAAA;EAEjC,SAAS,oBAAoB,CAAC,MAAc,EAAA;;MAG1C,IAAK,MAAc,kDAA2B,EAAE;EAC9C,QAAA,OAAO,MAAM,CAAA;EACd,KAAA;EAED,IAAA,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;EACrB,QAAA,OAAO,MAAM,CAAA;EACd,KAAA;;MAGD,MAAM,aAAa,GAAG,WAAW,CAAC,GAAG,CAAC,MAAM,CAAC,CAAA;EAC7C,IAAA,IAAI,aAAa,EAAE;EACjB,QAAA,OAAO,aAAa,CAAA;EACrB,KAAA;MAED,MAAM,KAAK,GAAG,IAAI,KAAK,CAAC,MAAM,EAAE,eAAe,CAAC,CAAA;EAChD,IAAA,WAAW,CAAC,GAAG,CAAC,MAAM,EAAE,KAAK,CAAC,CAAA;EAC9B,IAAA,OAAO,KAAK,CAAA;EACd,CAAC;EAEK,SAAU,QAAQ,CAAC,MAAc,EAAA;EACrC,IAAA,OAAO,oBAAoB,CAAC,MAAM,CAAC,CAAA;EACrC;;;;;;;;;;;;;"}